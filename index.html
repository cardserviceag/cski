
<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>csKI Chat</title>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script crossorigin src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>
  <style>
    body {
      margin: 0;
      font-family: "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
      background-color: #fafafa;
    }
    #root {
      max-width: 600px;
      margin: 20px auto;
    }
    .chat {
      border: 1px solid #ccc;
      border-radius: 8px;
      padding: 10px;
      height: 400px;
      overflow-y: auto;
      margin-bottom: 10px;
      background: #fff;
    }
    .msg {
      margin: 8px 0;
    }
    .msg.user {
      text-align: right;
    }
    .bubble {
      display: inline-block;
      padding: 8px 12px;
      border-radius: 16px;
      background: #eee;
    }
    .msg.user .bubble {
      background: #007bff;
      color: #fff;
    }
  </style>
</head>
<body>
  <header style="background:#fff;text-align:center;padding:10px;">
    <h1 style="margin:0;">csKI</h1>
  </header>
  <div id="root"></div>
  <script type="text/babel">
    const { useState, useEffect } = React;
    const API_KEY = ""; // <-- Insert your OpenAI API key here

    function detectEmotion(input) {
      const text = input.toLowerCase();
      if (text.match(/traurig|einsam|deprimiert/)) return "sad";
      if (text.match(/glÃ¼cklich|freude|zufrieden/)) return "happy";
      if (text.match(/stress|arbeit|Ã¼berlastet/)) return "stressed";
      if (text.match(/schmerz|weh|verletzung/)) return "pain";
      if (text.match(/angst|sorge|unsicher/)) return "fear";
      return "neutral";
    }

    function localReply(input, context, personality, moodTracker) {
      const emotion = detectEmotion(input);
      moodTracker[emotion] = (moodTracker[emotion] || 0) + 1;

      const responses = {
        Freund: {
          sad: ["Das klingt traurig ðŸ˜”. Willst du mir mehr erzÃ¤hlen?"],
          happy: ["Mega! ðŸ˜„ Was hat dich so gefreut?"],
          stressed: ["Klingt nach Stress. Soll ich dir kleine Tipps geben?"],
          pain: ["Autsch, das klingt schmerzhaft. Was genau tut weh?"],
          fear: ["Oh, das klingt beunruhigend. Wovor hast du Angst?"],
          neutral: ["Ich hÃ¶re dir zu. ErzÃ¤hl mir mehr."]
        }
      };

      const replyList = (responses[personality] && responses[personality][emotion]) || responses["Freund"]["neutral"];
      return replyList[Math.floor(Math.random() * replyList.length)];
    }

    async function gptReply(input, messages, personality) {
      if (!API_KEY) return null;

      const systemPrompt = `Du bist csKI, ein empathischer KI-Coach und Freund. PersÃ¶nlichkeit: ${personality}. Sei einfÃ¼hlsam, klar und hilfreich.`;

      try {
        const response = await fetch("https://api.openai.com/v1/chat/completions", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            Authorization: `Bearer ${API_KEY}`,
          },
          body: JSON.stringify({
            model: "gpt-4o-mini",
            messages: [
              { role: "system", content: systemPrompt },
              ...messages.map(m => ({
                role: m.sender === "user" ? "user" : "assistant",
                content: m.text,
              })),
              { role: "user", content: input },
            ],
          }),
        });

        const data = await response.json();
        if (data.error) return `API-Fehler: ${data.error.message}`;
        if (data.choices && data.choices.length > 0) return data.choices[0].message.content;

        return "Unbekannter Fehler von der API.";
      } catch (err) {
        return `Fehler beim API-Aufruf: ${err.message}`;
      }
    }

    function App() {
      const [messages, setMessages] = useState(() => {
        const saved = localStorage.getItem("chatHistory");
        return saved ? JSON.parse(saved) : [{
          sender: "ai",
          text: "Hallo! Ich bin csKI, dein KI-Coach. Welche PersÃ¶nlichkeit wÃ¼nschst du dir heute?"
        }];
      });
      const [input, setInput] = useState("");
      const [personality, setPersonality] = useState("Freund");
      const [moodTracker, setMoodTracker] = useState({});

      useEffect(() => {
        localStorage.setItem("chatHistory", JSON.stringify(messages));
      }, [messages]);

      const handleSend = async () => {
        if (!input) return;
        const userMessage = input;
        setMessages(prev => [...prev, { sender: "user", text: userMessage }]);
        setInput("");

        const lower = userMessage.toLowerCase();
        if (lower.includes("coach")) setPersonality("Coach");
        if (lower.includes("freund")) setPersonality("Freund");
        if (lower.includes("mentor")) setPersonality("Mentor");

        const mood = { ...moodTracker };
        let reply = localReply(userMessage, messages, personality, mood);

        const gptAnswer = await gptReply(userMessage, messages, personality);
        if (gptAnswer) reply = gptAnswer;

        setMoodTracker(mood);
        setMessages(prev => [...prev, { sender: "ai", text: reply }]);
      };

      const newChat = () => {
        localStorage.removeItem("chatHistory");
        setMessages([{ sender: "ai", text: "Neuer Start ðŸš€ â€“ Hallo, ich bin csKI! Welche PersÃ¶nlichkeit wÃ¼nschst du dir heute?" }]);
        setMoodTracker({});
      };

      return (
        <div>
          <h2>csKI â€“ Dein KI-Coach</h2>
          <p>PersÃ¶nlichkeit: <b>{personality}</b> (schreibe â€žCoachâ€œ, â€žFreundâ€œ oder â€žMentorâ€œ)</p>
          <button onClick={newChat} style={{ marginBottom: 10 }}>ðŸ†• Neuer Chat</button>

          <div className="chat">
            {messages.map((msg, i) => (
              <div key={i} className={"msg " + (msg.sender === "user" ? "user" : "")}>
                <span className="bubble">{msg.text}</span>
              </div>
            ))}
          </div>

          <div style={{ display: "flex", gap: 8 }}>
            <input
              value={input}
              onChange={e => setInput(e.target.value)}
              placeholder="Schreibe etwas..."
              style={{ flex: 1, padding: 8, borderRadius: 8, border: "1px solid #ccc" }}
              onKeyDown={e => { if (e.key === "Enter") handleSend(); }}
            />
            <button onClick={handleSend}>Senden</button>
          </div>
        </div>
      );
    }

    ReactDOM.createRoot(document.getElementById("root")).render(<App />);
  </script>
</body>
</html>
=======
diff --git a/index.html b/index.html
index 271ce51a69a1db5eb0d3088520ff00500888331f..35708c4187fcffbcca3de69014ad8dee0b84ab35 100644
--- a/index.html
+++ b/index.html
@@ -1,80 +1,203 @@
 <!DOCTYPE html>
 <html lang="de">
 <head>
-  <meta charset="UTF-8">
-  <meta name="viewport" content="width=device-width, initial-scale=1.0">
-  <title>DatenschutzerklÃ¤rung</title>
+  <meta charset="UTF-8" />
+  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
+  <title>csKI Chat</title>
+  <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
+  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
+  <script crossorigin src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>
   <style>
     body {
       margin: 0;
       font-family: "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
-      line-height: 1.6;
-      color: #333;
       background-color: #fafafa;
     }
-    header {
-      background: #fff;
-      padding: 20px;
-      text-align: center;
-      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
-    }
-    header img {
-      max-width: 200px;
-      height: auto;
+    #root {
+      max-width: 600px;
+      margin: 20px auto;
     }
-    main {
-      max-width: 800px;
-      margin: 40px auto;
-      padding: 0 20px;
+    .chat {
+      border: 1px solid #ccc;
+      border-radius: 8px;
+      padding: 10px;
+      height: 400px;
+      overflow-y: auto;
+      margin-bottom: 10px;
       background: #fff;
-      border-radius: 12px;
-      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
     }
-    h1, h2 {
-      font-weight: 600;
-      color: #222;
+    .msg {
+      margin: 8px 0;
+    }
+    .msg.user {
+      text-align: right;
     }
-    h1 {
-      text-align: center;
-      margin-top: 30px;
+    .bubble {
+      display: inline-block;
+      padding: 8px 12px;
+      border-radius: 16px;
+      background: #eee;
     }
-    p {
-      margin-bottom: 16px;
+    .msg.user .bubble {
+      background: #007bff;
+      color: #fff;
     }
   </style>
 </head>
 <body>
-  <header>
-    <img src="logo.png" alt="Logo">
+  <header style="background:#fff;text-align:center;padding:10px;">
+    <img src="logo.png" alt="csKI Logo" style="height:50px" />
   </header>
-  <main>
-    <h1>DatenschutzerklÃ¤rung</h1>
+  <div id="root"></div>
+  <script type="text/babel">
+    const { useState, useEffect } = React;
+    const API_KEY = ""; // <-- Insert your OpenAI API key here
+
+    function detectEmotion(input) {
+      const text = input.toLowerCase();
+      if (text.match(/traurig|einsam|deprimiert/)) return "sad";
+      if (text.match(/glÃ¼cklich|freude|zufrieden/)) return "happy";
+      if (text.match(/stress|arbeit|Ã¼berlastet/)) return "stressed";
+      if (text.match(/schmerz|weh|verletzung/)) return "pain";
+      if (text.match(/angst|sorge|unsicher/)) return "fear";
+      return "neutral";
+    }
+
+    function localReply(input, context, personality, moodTracker) {
+      const emotion = detectEmotion(input);
+      moodTracker[emotion] = (moodTracker[emotion] || 0) + 1;
+
+      const responses = {
+        Freund: {
+          sad: ["Das klingt traurig ðŸ˜”. Willst du mir mehr erzÃ¤hlen?"],
+          happy: ["Mega! ðŸ˜„ Was hat dich so gefreut?"],
+          stressed: ["Klingt nach Stress. Soll ich dir kleine Tipps geben?"],
+          pain: ["Autsch, das klingt schmerzhaft. Was genau tut weh?"],
+          fear: ["Oh, das klingt beunruhigend. Wovor hast du Angst?"],
+          neutral: ["Ich hÃ¶re dir zu. ErzÃ¤hl mir mehr."]
+        }
+      };
+
+      const replyList = (responses[personality] && responses[personality][emotion]) || responses["Freund"]["neutral"];
+      return replyList[Math.floor(Math.random() * replyList.length)];
+    }
+
+    async function gptReply(input, messages, personality) {
+      if (!API_KEY) return null;
+
+      const systemPrompt = `Du bist csKI, ein empathischer KI-Coach und Freund. PersÃ¶nlichkeit: ${personality}. Sei einfÃ¼hlsam, klar und hilfreich.`;
+
+      try {
+        const response = await fetch("https://api.openai.com/v1/chat/completions", {
+          method: "POST",
+          headers: {
+            "Content-Type": "application/json",
+            Authorization: `Bearer ${API_KEY}`,
+          },
+          body: JSON.stringify({
+            model: "gpt-4o-mini",
+            messages: [
+              { role: "system", content: systemPrompt },
+              ...messages.map(m => ({
+                role: m.sender === "user" ? "user" : "assistant",
+                content: m.text,
+              })),
+              { role: "user", content: input },
+            ],
+          }),
+        });
 
-    <h2>1. Verantwortlicher</h2>
-    <p>Card Service AG<br>Pilatusring 24<br>CH-5630 Muri AG<br>info@cardservice.ch</p>
+        const data = await response.json();
+        if (data.error) return `API-Fehler: ${data.error.message}`;
+        if (data.choices && data.choices.length > 0) return data.choices[0].message.content;
 
-    <h2>2. Allgemeines</h2>
-    <p>Der Schutz Ihrer Daten ist uns wichtig. Diese App verarbeitet keine personenbezogenen Daten auf unseren Servern.</p>
+        return "Unbekannter Fehler von der API.";
+      } catch (err) {
+        return `Fehler beim API-Aufruf: ${err.message}`;
+      }
+    }
+
+    function Avatar() {
+      return (
+        <div style={{ textAlign: "center" }}>
+          <img src="mascot.png" alt="Mascot" style={{ height: 48 }} />
+        </div>
+      );
+    }
+
+    function App() {
+      const [messages, setMessages] = useState(() => {
+        const saved = localStorage.getItem("chatHistory");
+        return saved ? JSON.parse(saved) : [{
+          sender: "ai",
+          text: "Hallo! Ich bin csKI, dein KI-Coach. Welche PersÃ¶nlichkeit wÃ¼nschst du dir heute?"
+        }];
+      });
+      const [input, setInput] = useState("");
+      const [personality, setPersonality] = useState("Freund");
+      const [moodTracker, setMoodTracker] = useState({});
+
+      useEffect(() => {
+        localStorage.setItem("chatHistory", JSON.stringify(messages));
+      }, [messages]);
+
+      const handleSend = async () => {
+        if (!input) return;
+        const userMessage = input;
+        setMessages(prev => [...prev, { sender: "user", text: userMessage }]);
+        setInput("");
 
-    <h2>3. Datenverarbeitung in der App</h2>
-    <p>- Alle eingegebenen Daten (z. B. Name, Link, Kontakt, E-Mail-Adresse) werden ausschlieÃŸlich lokal auf Ihrem Smartphone verarbeitet.<br>
-    - Die Daten werden nur genutzt, um Inhalte auf NFC-Tags zu schreiben.<br>
-    - Es erfolgt keine Ãœbertragung an uns oder an Dritte.</p>
+        const lower = userMessage.toLowerCase();
+        if (lower.includes("coach")) setPersonality("Coach");
+        if (lower.includes("freund")) setPersonality("Freund");
+        if (lower.includes("mentor")) setPersonality("Mentor");
 
-    <h2>4. Berechtigungen</h2>
-    <p>Die App benÃ¶tigt den Zugriff auf:<br>
-    â€“ <strong>NFC-Funktion Ihres GerÃ¤ts</strong> (zur Kommunikation mit NFC-Tags).<br>
-    Andere Berechtigungen werden nicht angefragt.</p>
+        const mood = { ...moodTracker };
+        let reply = localReply(userMessage, messages, personality, mood);
 
-    <h2>5. Speicherung</h2>
-    <p>Alle Daten verbleiben auf Ihrem GerÃ¤t. Wir haben keinerlei Zugriff.</p>
+        const gptAnswer = await gptReply(userMessage, messages, personality);
+        if (gptAnswer) reply = gptAnswer;
 
-    <h2>6. Rechte der Nutzer</h2>
-    <p>Da keine Daten von uns verarbeitet werden, entstehen Ihnen gegenÃ¼ber uns keine zusÃ¤tzlichen Rechte zur Auskunft oder LÃ¶schung. Alle Daten kÃ¶nnen Sie jederzeit auf Ihrem Smartphone selbst lÃ¶schen.</p>
+        setMoodTracker(mood);
+        setMessages(prev => [...prev, { sender: "ai", text: reply }]);
+      };
 
-    <h2>7. Ã„nderungen</h2>
-    <p>Sollten sich Funktionen der App Ã¤ndern, wird diese DatenschutzerklÃ¤rung angepasst.</p>
-  </main>
+      const newChat = () => {
+        localStorage.removeItem("chatHistory");
+        setMessages([{ sender: "ai", text: "Neuer Start ðŸš€ â€“ Hallo, ich bin csKI! Welche PersÃ¶nlichkeit wÃ¼nschst du dir heute?" }]);
+        setMoodTracker({});
+      };
+
+      return (
+        <div>
+          <h2>csKI â€“ Dein KI-Coach</h2>
+          <Avatar />
+          <p>PersÃ¶nlichkeit: <b>{personality}</b> (schreibe â€žCoachâ€œ, â€žFreundâ€œ oder â€žMentorâ€œ)</p>
+          <button onClick={newChat} style={{ marginBottom: 10 }}>ðŸ†• Neuer Chat</button>
+
+          <div className="chat">
+            {messages.map((msg, i) => (
+              <div key={i} className={"msg " + (msg.sender === "user" ? "user" : "")}>
+                <span className="bubble">{msg.text}</span>
+              </div>
+            ))}
+          </div>
+
+          <div style={{ display: "flex", gap: 8 }}>
+            <input
+              value={input}
+              onChange={e => setInput(e.target.value)}
+              placeholder="Schreibe etwas..."
+              style={{ flex: 1, padding: 8, borderRadius: 8, border: "1px solid #ccc" }}
+              onKeyDown={e => { if (e.key === "Enter") handleSend(); }}
+            />
+            <button onClick={handleSend}>Senden</button>
+          </div>
+        </div>
+      );
+    }
+
+    ReactDOM.createRoot(document.getElementById("root")).render(<App />);
+  </script>
 </body>
 </html>
-